{"version":3,"sources":["common.js"],"names":["parallaxing","wScroll","window","pageYOffset","parallax","document","querySelector","parallaxHeading","childNodes","parallaxParagraph","parallaxMore","addEventListener","this","innerWidth","params","translateYMore","Math","round","translateYLess","blur","opacityMore","floor","opacityLess","setAttribute","sendMail","modalForm","name","email","message","data","key","from_email","to","type","subject","html","xhr","XMLHttpRequest","open","readyState","DONE","status","console","log","send","JSON","stringify","displayModal","openlink","modals","closeLink","storage","localStorage","getItem","sessionStorage","setItem","value","classList","add","body","focus","remove","event","keyCode","contains","preventDefault","nameValue","emailValue","messageValue","alert","progressBar","doc","main","progressOuter","progressInner","max","percent","getElementsByTagName","createElement","cloneNode","appendChild","insertBefore","firstElementChild","scrollHeight","innerHeight","style","width","scrollingTop","scrollTop","doScrollTop","timeout","scrollY","cancelAnimationFrame","scrollBy","requestAnimationFrame","btnFade","documentElement","clientHeight","scrollTopBtn","toggle","scrollTimeout","documentMain","insertAdjacentElement","clearTimeout","setTimeout","historyHandler","mainPaddingLeft","Number","parseInt","getComputedStyle","paddingLeft","evt","elementFromPoint","history","replaceState","title","location","href"],"mappings":"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","file":"common.js","sourcesContent":["'use strict';\n(function() {\n  function parallaxing() {\n\n    var wScroll = window.pageYOffset;\n    var parallax = document.querySelector('.js-parallax');\n    var parallaxHeading = parallax.childNodes[0];\n    var parallaxParagraph = parallax.childNodes[1];\n    var parallaxMore = parallax.childNodes[2];\n\n    window.addEventListener('scroll', function() {\n      if (this.innerWidth > 600 && this.pageYOffset < 750) {\n        wScroll = this.pageYOffset; //window.scrollTop()\n        var params = {\n          translateYMore: Math.round(wScroll / 2),\n          translateYLess: Math.round(wScroll / 4),\n          blur: Math.round(wScroll / 10),\n          opacityMore: 1 - Math.floor(wScroll) / 200,\n          opacityLess: 1 - Math.floor(wScroll) / 300\n        };\n\n        parallaxHeading.setAttribute('style',\n          'transform:translateY(' + params.translateYMore + '%);');\n\n        parallaxParagraph.setAttribute('style',\n          'opacity:' + params.opacityMore + ';transform:translate3d(0,0,0) translateY(' + params.translateYLess + '%);color:rgba(71,82,82,' + params.opacityMore + ');');\n\n        // parallaxParagraph.setAttribute('style',\n        //   'opacity:' + params.opacityMore + ';transform:translate3d(0,0,0);translateY(' + params.translateY + '%);-webkit-filter:blur(' + params.blur + 'px);filter:blur(' + params.blur + 'px);');\n\n        parallaxMore.setAttribute('style',\n          'opacity:' + params.opacityLess + ';');\n\n        //console.log(wScroll);\n      }\n    });\n  }\n\n  function sendMail(modalForm, name, email, message) {\n    var data = {\n      'key': '-8KIDsmWFMy7aZUBmrBVmw',\n      'message': {\n        'from_email': email,\n        'to': [\n          {\n            'email': 'me@ifeature.net',\n            'name': 'YOUR_RECEIVER_NAME',\n            'type': 'to'\n          }\n        ],\n        'subject': 'Новое сообщение от ' + name + '',\n        'html': message\n      }\n    };\n\n    var xhr = new XMLHttpRequest();\n    xhr.open('post', 'https://mandrillapp.com/api/1.0/messages/send.json');\n\n    xhr.addEventListener('readystatechange', function() {\n      if (xhr.readyState === xhr.DONE && xhr.status === 200) {\n        console.log('Сообщение отправлено');\n      }\n    });\n\n    xhr.send(JSON.stringify(data));\n\n  }\n\n  function displayModal() {\n    var openlink = document.querySelector('.js-modal-show');\n    var modals = document.querySelector('.js-modals');\n\n    var modalForm = modals.querySelector('.js-form');\n\n    var name = modalForm.querySelector('#name');\n    var email = modalForm.querySelector('#email');\n    var message = modalForm.querySelector('#message');\n\n    var closeLink = modals.querySelector('.js-modal-hide');\n\n    var storage = {\n      name: localStorage.getItem('name'),\n      email: localStorage.getItem('email')\n    };\n\n    var local = {\n      name: sessionStorage.getItem('name'),\n      email: sessionStorage.getItem('email'),\n      message: sessionStorage.getItem('message')\n    };\n\n    name.addEventListener('change', function() {\n      sessionStorage.setItem('name', name.value);\n    });\n\n    email.addEventListener('change', function() {\n      sessionStorage.setItem('email', email.value);\n    });\n\n    message.addEventListener('change', function() {\n      sessionStorage.setItem('message', message.value);\n    });\n\n    openlink.addEventListener('click', function() {\n      modals.classList.add('modals_show');\n      document.body.classList.add('dimmed');\n\n      if (storage.name) {\n        name.value = storage.name;\n        email.focus();\n      }\n      if (storage.email) {\n        email.value = storage.email;\n        message.focus();\n      } else {\n        name.focus();\n      }\n\n    });\n\n    closeLink.addEventListener('click', function() {\n      modals.classList.remove('modals_show');\n      document.body.classList.remove('dimmed');\n    });\n\n    window.addEventListener('keydown', function(event) {\n      if (event.keyCode === 27) {\n        if (modals.classList.contains('modals_show')) {\n          modals.classList.remove('modals_show');\n          document.body.classList.remove('dimmed');\n        }\n      }\n    });\n\n    modalForm.addEventListener('submit', function(event) {\n      event.preventDefault();\n      var nameValue = name.value;\n      var emailValue = email.value;\n      var messageValue = message.value;\n\n      sendMail(modalForm, nameValue, emailValue, messageValue);\n      alert('Спасибо, за проявленный интерес! Отвечу Вам в ближайшее время!');\n\n      localStorage.setItem('name', name.value);\n      localStorage.setItem('email', email.value);\n\n      modals.classList.remove('modals_show');\n      document.body.classList.remove('dimmed');\n      name.value = '';\n      email.value = '';\n      message.value = '';\n    });\n  }\n\n  function progressBar() {\n    var doc, main, progressOuter, progressInner, max, percent;\n    doc = document;\n    main = document.getElementsByTagName('main')[0];\n    progressOuter = doc.createElement('div');\n    progressInner = progressOuter.cloneNode(true);\n    progressOuter.classList.add('js-progress-bar');\n    progressOuter.appendChild(progressInner);\n\n    main.insertBefore(progressOuter, main.firstElementChild);\n\n    addEventListener('scroll', function() {\n      max = doc.body.scrollHeight - innerHeight;\n      percent = (pageYOffset / max) * 100;\n      progressInner.style.width = percent + '%';\n    });\n  }\n\n  function scrollingTop() {\n    var scrollTimeout;\n    var documentMain = document.getElementsByTagName('main')[0];\n    var scrollTopBtn = document.createElement('button');\n\n    scrollTopBtn.classList.add('button', 'button_scroll-top', 'button_hidden');\n    documentMain.insertAdjacentElement('beforeend', scrollTopBtn);\n\n    scrollTopBtn.addEventListener('click', scrollTop);\n    addEventListener('scroll', function() {\n      clearTimeout(scrollTimeout);\n      scrollTimeout = setTimeout(btnFade, 50);\n    });\n\n    function scrollTop() {\n      function doScrollTop() {\n        var timeout;\n        if (scrollY === 0) {\n          cancelAnimationFrame(timeout);\n          return;\n        }\n        scrollBy(0, -10);\n        timeout = requestAnimationFrame(doScrollTop);\n      }\n      requestAnimationFrame(doScrollTop);\n    }\n\n    function btnFade() {\n      var html = document.documentElement;\n      if ((html.clientHeight + scrollY) / html.scrollHeight * 100 > 50) {\n        scrollTopBtn.classList.toggle('button_hidden', false);\n      } else {\n        scrollTopBtn.classList.toggle('button_hidden', true);\n      }\n    }\n  }\n\n  function historyHandler() {\n    var main = document.getElementsByTagName('main')[0];\n    var mainPaddingLeft = Number.parseInt(getComputedStyle(main).paddingLeft);\n    var scrollTimeout;\n    // console.log(mainPaddingLeft);\n\n    addEventListener('scroll', function(evt) {\n      clearTimeout(scrollTimeout);\n      scrollTimeout = setTimeout(function() {\n        // console.log(mainPaddingLeft);\n        console.log(document.elementFromPoint(mainPaddingLeft, 0));\n      }, 50);\n    });\n\n    history.replaceState(null, document.title, document.location.href);\n\n  }\n\n  displayModal();\n  parallaxing();\n  progressBar();\n  scrollingTop();\n  historyHandler();\n\n  console.log('%cHave a nice day!', 'color: #3498db; font-size: 16px;');\n}());\n\n"],"sourceRoot":"/source/"}